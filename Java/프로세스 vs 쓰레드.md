## 프로세스 vs 쓰레드

- **프로세스**
  - **자원 할당의 단위**
  - 프로세서(CPU)가 실행 중인 프로그램이며 각 프로세스는 독립적이다.
  - 프로세스는 1개 이상의 쓰레드를 가지고 있다.

- **쓰레드**
  - **작업 단위**
  - 쓰레드는 프로세스 내에서 각각 Stack만 따로 할당받고 Code, Data, Heap 영역은 공유한다.

**프로그램 → 프로세스 → 쓰레드**

프로그램이란, 어떤 작업을 위한 정적인 상태의 파일을 말한다. 프로그램을 실행함으로써 해당 파일은 메모리를 할당받게되고, 이 상태를 동적인 상태라고 하며 프로세스가 된다.

쓰레드는 프로세스의 자원을 이용하여 작업을 수행한다.

### 프로세스 구조

![img](https://github.com/dilmah0203/TIL/blob/main/Image/Process1.png)  

- Code : 컴파일된 소스코드가 저장되는 영역
- Data : 전역 변수, static 변수가 저장되는 영역
- Heap : 동적으로 생성되는 데이터 저장되는 영역
- Stack : 호출된 함수 혹은 지역 변수가 저장되는 영역

## 멀티 프로세스와 멀티 쓰레드

멀티 프로세스는 하나 이상의 프로세스들을 동시에 처리하는 과정을 의미하고 멀티 쓰레드는 하나의 프로세스 내에서 여러개의 쓰레드를 생성함으로써 작업을 처리하는 과정을 의미한다. 이 둘의 공통점은 여러 작업을 동시에 혹은 병렬적으로 처리함으로써 작업 속도를 높일 수 있다는 장점이 있다.
  
### 멀티 프로세스에서 발생할 수 있는 문제점
  
CPU는 한 번에 한개의 프로세스만 처리가 가능하다. 여러 작업이 동시에 실행되는 것처럼 보이지만 CPU는 계속해서 프로세스들을 바꿔주는 일을 내부적으로 진행하고 있다. 하나의 프로세스에 대한 정보들을 저장해놓고, 새로운 프로세스에 대한 정보를 가져오고 메모리를 할당해주는 과정을 **문맥 교환(Conetext Switching)이라고 하는데, 이 문맥교환 동안에 소요되는 시간과 메모리로 인해 오버헤드 발생의 가능성이 있으며 CPU성능 저하가 될 수 있다.**
  
### 멀티 쓰레드의 장점
  
쓰레드는 한 프로세스 내부의 실행단위이기 때문에 프로세스 내부에서 Code, Data, Heap 영역을 서로 다른 쓰레드끼리 공유할 수 있다. CPU에서는 쓰레드 간 문맥교환을 위해 PCB 내부에 있는 Register Block을 통해 쓰레드를 구분하는데, 멀티 쓰레드로 분할 작업을 수행하게 된다면 Code, Data, Heap 영역을 메모리에 올리고 내리는 무거운 작업을 할 필요가 없어진다. 쓰레드를 구분 할 Register Block만 교체하면 되기 때문이다.
  
### 무조건 멀티 쓰레드를 사용하는 것이 좋을까?

멀티 프로세스는 독립된 구조이기 때문에 안정성이 높은 반면 멀티 쓰레드는 서로 독립적이지 못하므로 오류가 생길 시에 같은 메모리 영역(Code, Data, Heap)을 공유하고 있는 다른 쓰레드에게도 영향을 미칠 수 있기 때문에 동시에 같은 데이터에 접근할 경우 문제가 발생할 수 있다. 이런 상황을 방지하기 위해 동기화를 고려해야 한다.


