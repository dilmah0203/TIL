## 운영체제와 커널

- 운영체제란 컴퓨터 하드웨어 바로 위에 설치되어 사용자 및 다른 모든 소프트웨어와 하드웨어를 연결하는 소프트웨어 계층
- 컴퓨터 시스템의 **자원을 효율적으로 관리**
  - 중앙 처리 장치(CPU), 기억장치, 입출력 장치 등의 효율적 관리
  - 실행중인 프로그램들에게 CPU를 번갈아 할당, 메모리 공간을 적절히 분배
- 컴퓨터 시스템을 편리하게 사용할 수 있는 환경을 제공

![img](https://github.com/dilmah0203/TIL/blob/main/Image/computer%20architecture.png)

그렇다면 운영체제는 어디에 위치해 있길래 모든 시스템 자원을 관리하고 제어하는 것일까? 사실 운영체제도 디스크에 저장되어 있다가 실행할 시기가 오면, 메모리에 올라와서 실행되어 사용자 인터페이스를 제공해준다. 운영체제는 우선순위가 높을 뿐 하나의 소프트웨어이기 때문이다.

하지만 운영체제의 용량은 매우 크다. 그렇기 때문에 메모리에 모두 올라와 실행하기에는 비효율적이다. 그렇다면 어떻게 해야할까? 정말 필요한 것들만 메모리에 올리면 된다. 이렇게 메모리에 올라간 운영체제의 특정 부분을 커널이라고 한다.

커널은 아래와 같은 기능을 수행한다.

- 프로세스 관리 및 CPU 스케줄링
  - 프로세스마다 CPU를 사용할 수 있는 시간을 분배 및 관리한다. 
- 한정된 메모리를 어떻게 쪼개어 쓸지 메모리 관리
- 각기 다른 입출력장치와 컴퓨터 간에 어떻게 정보를 주고 받을지 입출력 관리
- 디스크에 파일을 어떻게 보관할지 파일관리
  
## 시분할(time sharing) 처리 방식

- 현대 운영체제에서 사용하는 방식이다.
- 여러 작업을 수행할 때 CPU를 사용하는 시간을 잘개 쪼개서, 여러 개의 응용 프로그램이 동시에 실행하는 기법
- 다중 사용자를 지원하고, 일괄 처리 시스템에 비해 짧은 응답 시간을 가짐
- 멀티 태스킹
  - 단일 CPU에서, 여러 응응 프로그램이 동시에 실행되는것처럼 보이도록 하는 시스템
- 멀티 프로그래밍
  - 최대한 많은 CPU를 활용하도록 하는 시스템
- 멀티 프로세싱
  - 여러 CPU에서 하나의 응용 프로그램을 병렬로 실행해서 속도를 높이는 기법

## 시스템 콜

우리가 사용하는 대부분의 프로그램은 외부의 특정 자원을 불러와서 작업을 처리해야하는 상황들이 많이 발생한다. 이럴 때, 운영체제에게 하드웨어에 접근해 자원을 가져오라고 말해줘야 한다. 이 때 **명령어로 커널을 불러오는 상황**을 시스템 콜이라고 한다.

운영체제는 자원관리 외에 보안기능도 수행하고 있어 허가 받지 않은 사용자는 마음대로 하드웨어 자원에 접근할 수 없다. 즉, 커널은 시스템 콜이 발생하면 CPU를 커널 모드로 전환하여 자신들의 작업을 수행한다.

## 인터럽트

인터럽트란 프로세스 실행 도중 예기치 않은 상황이 발생할 때 발생한 상황을 처리한 후 실행 중인 작업으로 복귀하는 것을 말한다.

![img2](https://github.com/dilmah0203/TIL/blob/main/Image/Interrupt%20Service%20Routine.png)

사용자와 운영체제는 시스템 자원을 공유하기 때문에 사용자에 제한을 두지 않으면 메모리 내 주요 자원을 망가뜨릴 위험이 있다. 따라서 사용자의 자원 접근을 막는 보호 장치가 필요하고, 이 것이 이중 동작 모드이다. 이중 동작 모드는 사용자가 접근할 수 없는 커널 모드, 접근할 수 있는 사용자 모드로 나뉜다.

![img2](https://github.com/dilmah0203/TIL/blob/main/Image/Interrupt%20Service%20Routine2.png)

프로세스는 사용자 모드에서 실행되다가 운영체제에게 시스템 사용을 요청하면 커널 모드로 전환되어 요청된 시스템을 실행한 후 다시 사용자 모드로 전환한다. (시스템 콜) 

시스템 콜은 하나의 인터럽트로 취급된다. 커널 모드와 사용자 모드를 구분하기 위해서는 mode bit가 사용되며 0이 커널 모드, 1이 사용자 모드이다. 운영체제는 일부 명령들을 특권 명령으로 지정하고 커널 모드에서만 실행되게 하며 사용자 모드에서 실행하려고 하면 trap을 건다.








