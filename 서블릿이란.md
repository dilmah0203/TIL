## 서블릿(Servlet)이란?

서블릿이란 클라이언트의 요청을 처리하고 그 결과를 반환하는 Servlet 클래스의 구현 규칙을 지킨 자바 웹 프로그래밍 기술이다.

![img](https://github.com/dilmah0203/TIL/blob/main/Image/HTTP%20Request2.png)

개발자들이 위와 같은 HTTP 요청을 직접 해석하고 처리하여 응답을 만들어야 한다면 어떨까? HTTP 형태의 요청을 직접 파싱 하는 것보다 `HttpServletRequest.getMethod()`처럼 HttpServletRequest의 메소드를 호출하여 정보를 얻는 것이 더 편할 것이다. 서블릿을 이용하여 웹 요청을 다루게 되면 개발자들은 비즈니스 로직에 더 집중할 수 있게 된다. 

서블릿은 service() 메소드만 재정의하여 처리 방법을 지정하면 된다.

### Servlet 특징

- 클라이언트의 요청에 대해 동적으로 작동하는 웹 어플리케이션 컴포넌트
- Java Thread를 이용하여 동작
- HTTP 프로토콜 서비스를 지원하는 javax.servlet.http.HttpServlet 클래스를 상속받는다.

### Servlet 동작 방식

![img2](https://github.com/dilmah0203/TIL/blob/main/Image/Servlet0.png)

1. 클라이언트가 URL을 입력하면 HTTP Request가 Servlet Container로 전송
2. 요청을 전송받은 Servlet Container는 HttpServletRequest,HttpServletResponse 객체를 생성
3. 설정 파일(web.xml)을 참고하여 클라이언트가 요청한 URL이 어떤 서블릿에 대한 요청인지 찾는다.
4. 해당 서블릿 인스턴스 존재 유무를 확인하여 없으면 생성(init()), 있으면 서블릿 컨테이너에 쓰레드를 생성하고 service() 메소드를 호출한 후 클리아언트의 GET, POST여부에 따라 doGet() 또는 doPost()를 호출
5. doGet() or doPost() 메소드는 동적 페이지를 생성한 후 HttpServletResponse객체에 응답을 보냄
6. 응답을 처리한 HttpServletRequest, HttpServletResponse 두 객체는 소멸

> 서블릿은 왜 생성만 하고 소멸시키는 동작을 하지 않을까?

서블릿이 싱글톤으로 관리되기 때문이다. 서블릿은 소멸하지 않고 있다가 다음에 같은 요청이 들어오면 서블릿 컨테이너에 의해 또 호출되어 사용된다.

## Servlet Container(서블릿 컨테이너)

서블릿 컨테이너는 서블릿 생명주기를 관리하는 객체로 다음과 같이 동작한다.

![img3](https://github.com/dilmah0203/TIL/blob/main/Image/Servlet%20Lifecycle.png)

1. 클라이언트의 요청이 들어오면 서블릿 컨테이너는 해당 서블릿이 메모리에 있는지 확인하고, 없을 경우 init() 메소드를 호출하여 적재한다. init()메소드는 처음 한번만 실행된다.
2. init()이 호출된 후 클라이언트의 요청에 따라 service() 메소드를 통해 요청에 대한 응답이 분기된다.
3. 서블릿 컨테이너가 서블릿에 종료 요청을 하면 destroy()메소드가 호출되는데 마찬가지로 한번만 실행된다.


